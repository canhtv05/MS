syntax = "proto3";

option java_multiple_files = true;
option java_package = "com.leaf.common.grpc";
option java_outer_classname = "FileProto";

service FileGrpcService {
    rpc uploadFiles(UploadFilesRequest) returns (FileResponse);
    rpc uploadImage(UploadOneImageRequest) returns (ImageResponse);
    rpc uploadVideo(UploadOneVideoRequest) returns (VideoResponse);
    rpc getFileByIds(GetFilesByIdsRequest) returns (GetFilesByIdsResponse);
    rpc deleteById(DeleteByIdRequest) returns (DeleteByIdResponse);
}

message UploadOneImageRequest {
    bytes file = 1;
    ResourceType resourceType = 2;
    string userId = 3;
}

message UploadOneVideoRequest {
    bytes file = 1;
    ResourceType resourceType = 2;
    string userId = 3;
}

message UploadFilesRequest {
    repeated bytes files = 1;
    ResourceType resourceType = 2;
    string userId = 3;
}

message GetFilesByIdsRequest {
    repeated string ids = 1;
}

message GetFilesByIdsResponse {
    repeated FileResponse files = 1;
}

message DeleteByIdRequest {
    string fileId = 1;
}

message DeleteByIdResponse {
    bool success = 1;
}

message VideoResponse {
    double playtimeSeconds = 1;
    string playtimeString = 2;
    string contentType = 3;
    string videoUrl = 4;
    string thumbnailUrl = 5;
    int64 fileSize = 6;
    string originFileName = 7;
    string publicId = 8;
}

message ImageResponse {
    string contentType = 1;
    string imageUrl = 2;
    int64 fileSize = 3;
    string originFileName = 4;
    string publicId = 5;
}

message FileResponse {
    string ownerId = 1;
    int64 totalSize = 2;

    repeated VideoResponse videos = 3;
    repeated ImageResponse images = 4;
}

enum ResourceType {
    RESOURCE_TYPE_UNSPECIFIED = 0;
    AVATAR = 1;
    COVER = 2;
    POST = 3;
    COMMENT = 4;
    MESSAGE = 5;
    RESOURCE_OTHER = 6;
}